---
# Main deployment playbook for dotfiles
- name: Deploy dotfiles using ansible-role-dotmodules
  hosts: localhost
  vars:
    dotmodules:
      repo: "file://{{ playbook_dir }}/../modules"
      dest: "{{ ansible_env.HOME }}/.dotmodules"
      install:
        - 1password
        - alfred
        - bartender
        - bin
        - chatgpt
        - chrome
        - claude
        - cursor
        - database
        - docker
        - dropbox
        - editor
        - finances
        - firefox
        - flux
        - git
        - go
        - grammarly
        - handbrake
        - iterm
        - karabiner
        - licecap
        - macos
        - media
        - ngrok
        - node
        - obsidian
        - productivity
        - rust
        - security
        - sequel-ace
        - speckit
        - spotify
        - tmux
        - vscode
        - zsh
    # Configure MAS path for x86_64 Macs
    mas_path: "/usr/local/bin/mas"
  roles:
    - role: ansible-role-dotmodules
      vars:
        mas_path: "/usr/local/bin/mas"
        # Additional workarounds for geerlingguy.mac collection
        homebrew_install_path: "/opt/homebrew"
        homebrew_user: "{{ ansible_user_id }}"
        homebrew_group: "admin"
        homebrew_check_for_updates: false
        homebrew_upgrade_all_packages: false
        homebrew_clear_cache: false
