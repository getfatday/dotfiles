---
# Main deployment playbook for dotfiles
- name: Deploy dotfiles using ansible-role-dotmodules
  hosts: localhost
  vars:
    dotmodules:
      repo: "file://{{ playbook_dir }}/../modules"
      dest: "{{ ansible_env.HOME }}/.dotmodules"
      install:
        - git
        - macos
        - 1password
        - zsh
        - handbrake
        - finances
        - node
        - iterm
        - alfred
        - obsidian
    # Configure MAS path for x86_64 Macs
    mas_path: "/usr/local/bin/mas"
  roles:
    - role: ansible-role-dotmodules
      vars:
        mas_path: "/usr/local/bin/mas"
        # Skip Homebrew permission fixes to avoid sudo requirement
        homebrew_fix_permissions: false
        # Set empty password to avoid sudo prompts
        ansible_become_password: ""
        # Running in x86_64 mode (Rosetta 2)
